$(document).ready(function(){var goodNum;var userId=common.user_data().cuserInfoid;var source="userId"+userId;var sign=md5(source+"key"+common.secretKey()).toUpperCase();var goodsId;var systemTime="";var count="";var type;var isTrue=false;var test=location.href.toUpperCase();var words=test.split('#');function isLink(){for(var i=1;i<words.length;i+=1){if(String(words[i]).indexOf('GOODSID')!=-1){isTrue=true;type=words[i].substring(words[i].indexOf('=')+1);return type}}};isLink();if(isTrue){goodsDetailsData(type)}else{goodsId=sessionStorage.goodsId;goodsDetailsData(goodsId)};function goodsDetailsData(goodsId){$.ajax({url:common.http,type:"post",dataType:"jsonp",data:{method:'goods_show',goodsId:goodsId},success:function(data){if(data.statusCode=="100000"){goodsDetailsShow(data)}},error:function(data){common.prompt(str)}})};var html='',html1='';function goodsDetailsShow(data){var imgArr=data.data.goodsInfo.goodsPics.split('@');goodsBanner(imgArr);$('.gd_goodName').html(data.data.goodsInfo.goodsName);$('.gd_specification').html(data.data.goodsInfo.specInfo);$('.gd_price').html('<span>￥'+data.data.goodsInfo.nowPrice+'</span>&nbsp;&nbsp;<del>￥'+data.data.goodsInfo.nomalPrice+'</del>');if(data.data.killGoodsDetail.startTime.replace(/\-/g,"\/")>data.data.killGoodsDetail.newDate.replace(/\-/g,"\/")){$('.gd_number button').addClass("float_right").html("即将开始")}else{$('.gd_number button').addClass("float_right1").html("立即秒杀")};if(data.data.goodsInfo.goodsContext){$('.goodsDetails_box2_').show().html(data.data.goodsInfo.goodsContext)}};function goodsBanner(imgArr){var arr1=[];for(var i in imgArr){if(imgArr[i]!=''){arr1.push(imgArr[i])}};for(var j in arr1){html+='<div class="swiper-slide"><img src="'+arr1[j]+'" /></div>'};$(".goodsDetails_img_box .swiper-wrapper").append(html);var mySwiper=new Swiper('.goodsDetails_img_box',{direction:'horizontal',loop:true,autoplay:5000,paginationClickable:true,autoplayDisableOnInteraction:false,pagination:'.swiper-pagination'})};$(".header_left").on('click',function(){window.history.back()});function getSkillCount(userId,sign,source){$.ajax({url:common.http,dataType:'jsonp',data:{method:"user_kill_chance",userId:userId,tokenId:common.tokenId(),sign:sign,source:source},success:function(data){if(data.statusCode=="100000"){if(data.data.goodsInfo){count=data.data.count}else{count="0"}$('.seckill_notice span').html(count)}},error:function(data){common.comprot(data.statusStr)}})};function system(){$.ajax({url:common.http,dataType:'jsonp',data:{method:"system_config_constant"},success:function(data){if(data.statusCode=="100000"){systemTime=data.data.system_current_time;}},error:function(data){common.comprot(data.statusStr)}})};if(common.getIslogin()){getSkillCount(userId,sign,source)};$('.gd_number').on('click',".float_right1",function(){if(common.getIslogin()){if(count>0){localStorage.setItem("orderType","2");sessionStorage.setItem("setBack","4");window.location.href='order_set_charge.html'}else{common.prompt('您当前没有秒杀机会')}}else{window.location.href="login.html"}});window.onscroll=function(){var scroll=document.body.scrollTop||window.pageYOffset||document.documentElement.scrollTop;if(scroll>=600){$('.toTop').show()}else{$('.toTop').hide()}};$('.toTop').on('click',function(){$('html,body').animate({scrollTop:0},500)})});