//请求地址公用 获取tokenId公用
define(function(){
	var $ = require('jquery');

var common={http:"http://api.grhao.com/server/api.do",pageSize:'10',pageNo:'1',istrue:true,isfalse:false,isalert:0,pwdReg:/^[^\s]{6,20}$/,phoneNumberReg:/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$|(^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[6|7|8]|18[0-9])\d{8}$)/,bankCardReg:/^\d{16}|\d{19}$/,regIdCard:/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/,stopEventBubble:function(event){var e=event||window.event;if(e&&e.stopPropagation){return e.stopPropagation()}else{return e.cancelBubble=true}},isPc:function(){var sUserAgent=navigator.userAgent.toLowerCase();var bIsIpad=sUserAgent.match(/ipad/i)=="ipad";var bIsIphoneOs=sUserAgent.match(/iphone os/i)=="iphone os";var bIsMidp=sUserAgent.match(/midp/i)=="midp";var bIsUc7=sUserAgent.match(/rv:1.2.3.4/i)=="rv:1.2.3.4";var bIsUc=sUserAgent.match(/ucweb/i)=="ucweb";var bIsAndroid=sUserAgent.match(/android/i)=="android";var bIsCE=sUserAgent.match(/windows ce/i)=="windows ce";var bIsWM=sUserAgent.match(/windows mobile/i)=="windows mobile";if(bIsIpad||bIsIphoneOs||bIsMidp||bIsUc7||bIsUc||bIsAndroid||bIsCE||bIsWM){return 1}else{return 2}},callback:function(obj){obj.on('click',function(){window.history.back()})},tokenId:function(){if(localStorage.getItem('tokenId')){return JSON.parse(localStorage.tokenId)}else{return 0}},secretKey:function(){if(localStorage.getItem('secretKey')){return JSON.parse(localStorage.secretKey)}else{return 0}},user_data:function(data){if(localStorage.getItem('user_data')){return user_data={cuserInfoid:JSON.parse(localStorage.getItem('user_data')).cuserInfoid,firmId:JSON.parse(localStorage.getItem('user_data')).firmId,faceImg:JSON.parse(localStorage.getItem('user_data')).faceImg,petName:JSON.parse(localStorage.getItem('user_data')).petName,realName:JSON.parse(localStorage.getItem('user_data')).realName,idCard:JSON.parse(localStorage.getItem('user_data')).idCard,mobile:JSON.parse(localStorage.getItem('user_data')).mobile,sex:JSON.parse(localStorage.getItem('user_data')).sex}}else{return 0}},prompt:function(str){var ele=document.createElement('div');ele.className='prompt';document.body.appendChild(ele);$('.prompt').html(str);$('.prompt').css({'left':'50%'});$('.prompt').css("margin-left",-(($('.prompt').width())/2)+'px');setTimeout(function(){$('.prompt').css("margin-left",-($('.prompt').width()/2+20)+'px')},10);$('.prompt').show().animate({'bottom':'100'},300);setTimeout(function(){$('.prompt').remove()},2000)},autoLogin:function(){$.ajax({url:common.http,type:"post",dataType:"jsonp",data:{method:'auto_login',tokenId:common.tokenId()},success:function(data){console.log(JSON.stringify(data));if(data.statusCode=='100000'){var user_data={cuserInfoid:data.data.cuserInfo.id,firmId:data.data.cuserInfo.firmId,faceImg:data.data.cuserInfo.faceImg,petName:data.data.cuserInfo.petName,realName:data.data.cuserInfo.realName,idCard:data.data.cuserInfo.idcard,mobile:data.data.cuserInfo.mobile,sex:data.data.cuserInfo.sex};localStorage.setItem("user_data",JSON.stringify(user_data));localStorage.setItem("tokenId",JSON.stringify(data.data.tokenId));localStorage.setItem("secretKey",JSON.stringify(data.data.secretKey))}else{common.prompt(data.statusStr);localStorage.clear()}},error:function(data){common.prompt(str);localStorage.clear()}})},getIslogin:function(){if(localStorage.getItem('user_data')){return 1}else{return 0}},txq:function(ele,good_sta){$(ele).on("click",function(){var self = this;self.stopEventBubble();var goodsId=$(this).attr("data");sessionStorage.setItem("goodsId",goodsId);sessionStorage.setItem('good_sta',good_sta);})},footjomp:function(obj){obj.on("click",function(){switch($(this).index()){case 0:if(common.getIslogin()){window.location.href="often_shop.html"}else{window.location.href="login.html"}break;case 1:window.location.href="moreGoods.html";break;case 2:window.location.href="wo.html";break}})},bannerShow:function(data){console.log("11111");var html='';for(var i=0 in data){if(data[i].linkUrl==""){html+='<div class="swiper-slide"><img src="'+data[i].adLogo+'" /></div>'}else{html+='<div class="swiper-slide"><a href="'+data[i].linkUrl+'"><img src="'+data[i].adLogo+'" /></a></div>'}}$(".index_banner .swiper-wrapper").append(html);var mySwiper=new Swiper('.index_banner',{direction:'horizontal',loop:true,autoplay:5000,paginationClickable:true,autoplayDisableOnInteraction:false,pagination:'.swiper-pagination'})},alertShow:function(obj){obj.on('click',function(e){common.stopEventBubble(e);$('.alert_box,.my_bg').css({'display':'block'});$("body").css("overflow-y","hidden")})},alertHide:function(){$('.alert_delete').on('click',function(e){common.stopEventBubble(e);$('.alert_box,.my_bg').css({'display':'none'});$("body").css("overflow-y","auto")});$('.my_bg').on('click',function(e){common.stopEventBubble(e);$('.alert_box,.my_bg').css({'display':'none'});$("body").css("overflow-y","auto")})}};
module.exports = common;
});