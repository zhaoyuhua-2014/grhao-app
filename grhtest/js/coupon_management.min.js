 define(function(require, exports, module){

    require('jquery');
    var common = require('../lib/common');
    require('mdData');var userId=common.user_data().cuserInfoid;var source="userId"+userId;var sign=md5(source+"key"+common.secretKey()).toUpperCase();var pageNo=common.pageNo;var pageSize=common.pageSize;cuopon(userId,pageNo,pageSize,sign,source);function cuopon(userId,pageNo,pageSize,sign,source){$.ajax({url:common.http,type:'post',dataType:'jsonp',data:{method:'couponInfo_manager',userId:userId,pageNo:pageNo,pageSize:pageSize,tokenId:common.tokenId(),sign:sign,source:source},success:function(data){cuopon_show(data)},error:function(data){common.prompt(data.statusStr)}})};function cuopon_show(data){var html='';isLast=data.data.lastPage;if(isLast){$('.lodemore').html('没有更多数据了').show()}else{$('.lodemore').html('点击加载更多数据').show()}for(var i in data.data.list){html+='<div class="cuopon_management_content clearfloat cuopon_status1'+data.data.list[i].status+'">';html+='		<div class="cuopon_management_content_left">'+data.data.list[i].couponMoney+'元</div>';html+=' 	<div class="cuopon_management_content_right">';html+='			<div class="cuopon_management_title">'+data.data.list[i].couponName+'</div>';html+='			<ul class="cuopon_management_message">';html+='				<li>有效期至:'+data.data.list[i].endTime+'</li>';html+='				<li>金额要求:订单金额满'+data.data.list[i].leastOrderMoney+'元可用</li>';if(data.data.list[i].howGet=='1'){html+='			<li>来源:好友推荐赠送</li>'}else if(data.data.list[i].howGet=='2'){html+='			<li>来源:微博晒单成功赠送</li>'}else if(data.data.list[i].howGet=='3'){html+='			<li>来源:微信晒单成功赠送</li>'}else if(data.data.list[i].howGet=='4'){html+='			<li>来源:订单促销活动赠送</li>'}else if(data.data.list[i].howGet=='5'){html+='			<li>来源:随意赠送</li>'}else if(data.data.list[i].howGet=='6'){html+='			<li>来源:自助领取</li>'}else{html+='			<li>来源:自助领取</li>'}html+='			</ul>';html+='		</div>';html+='</div>'};$('.cuopon_management_contain').append(html)};$('.cuopon_management_contain').on('click','.cuopon_status11',function(){window.location.href="../index.html"});$('.lodemore').on('click',function(){if($(this).html()!='没有更多数据了'){pageNo+=1;cuopon(userId,pageNo,pageSize,sign,source)}});$('.header_left').on('click',function(){window.location.href='my.html'});$('.cuopon_management_top_left').on('click',function(){window.location.href='cuopon.html'});var code="YHQ-DESC";function contact(code){$.ajax({url:common.http,dataType:'jsonp',data:{method:'grh_desc',code:code},success:function(data){if(data.statusCode="100000"){alertShow(data)}else{common.prompt(data.strStatus)}},error:function(data){common.prompt(data.strStatus)}})};function alertShow(data){var str=data.data.desc;$('.alert_title').html(data.data.title);$('.alert_content').html(str.replace(/\r\n/g,"<br>"))};var obj=$('.cuopon_management_top_right');common.alertShow(obj);common.alertHide();contact(code)});