/**
 * MobileWeb ͨ�ù������֣����õ� UA �жϡ�ҳ�����䡢search ����ת ��ֵ�ԡ�
 * �� JS Ӧ�� head �о�����������룬�����ػ档
 *
 * fixScreen �����������������䣬�÷����Զ�ִ�С�
 *      1. ���? ��Ӧ meta ��ǩд�� -- <meta name="viewport" content="width=750">
 *          �÷�������ȡ width ֵ��������� scale �������ֵ��
 *          ע�⣺ ��� meta ��ǩ��ָ���� initial-scale�� �÷������������?����ִ�У���
 *      2. REM: ����д meta ��ǩ���÷������ dpr �Զ���ɣ����� html ��ǩ�м��� data-dpr �� font-size ��������ֵ��
 *          �÷���Լ��IOS ϵͳ��� dpr = 3������ϵͳ dpr = 1��ҳ��ÿ dpr ����ȣ���ҳ����/dpr�� = 750��REM �����ֵΪ 16��
 *          ��Ӧ css �������κε��Գߴ��ʹ�� rem ��λ��rem Ĭ�Ͽ��Ϊ �Ӿ����� / 16;
 *              scss �� $ppr(pixel per rem) ����д�� -- $ppr: 750px/16/1rem;
 *                      Ԫ�سߴ�д�� -- html { font-size: $ppr*1rem; } body { width: 750px/$ppr; }��

 */

define(function(require, exports, module){
window.mobileUtil = (function(win,doc){var UA=navigator.userAgent,isAndroid=/android|adr/gi.test(UA),isIos=/iphone|ipod|ipad/gi.test(UA)&&!isAndroid,isMobile=isAndroid||isIos;return{isAndroid:isAndroid,isIos:isIos,isMobile:isMobile,isNewsApp:/NewsApp\/[\d\.]+/gi.test(UA),isWeixin:/MicroMessenger/gi.test(UA),isQQ:/QQ\/\d/gi.test(UA),isYixin:/YiXin/gi.test(UA),isWeibo:/Weibo/gi.test(UA),isTXWeibo:/T(?:X|encent)MicroBlog/gi.test(UA),tapEvent:isMobile?'tap':'click',fixScreen:function(){var metaEl=doc.querySelector('meta[name="viewport"]'),metaCtt=metaEl?metaEl.content:'',matchScale=metaCtt.match(/initial\-scale=([\d\.]+)/),matchWidth=metaCtt.match(/width=([^,\s]+)/);if(!metaEl){}else if(isMobile&&!matchScale&&(matchWidth&&matchWidth[1]!='device-width')){var width=parseInt(matchWidth[1]),iw=win.innerWidth||width,ow=win.outerWidth||iw,sw=win.screen.width||iw,saw=win.screen.availWidth||iw,ih=win.innerHeight||width,oh=win.outerHeight||ih,ish=win.screen.height||ih,sah=win.screen.availHeight||ih,w=Math.min(iw,ow,sw,saw,ih,oh,ish,sah),scale=w/width;if(scale<1){metaEl.content=metaCtt+','+fillScale(scale)}}function fillScale(scale){return 'initial-scale='+scale+',maximum-scale='+scale+',minimum-scale='+scale+',user-scalable=no'}}}})(window,document);
window.mobileUtil.fixScreen();
var timer = setTimeout(function(){window.mobileUtil.fixScreen();clearTimeout(timer);timer=null;},100);
module.exports = window.mobileUtil;
});

